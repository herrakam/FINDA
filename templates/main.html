<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        html{
            top:0;
            left:0;
        }
        body{
            margin:0;
        }
        body >* {
            width:100%;

        }
        .header, .footer{
            height: 50px;
        }
        .header{
            background: skyblue;
            position: fixed;
        }
        .topBody, .bottomBody{
            height:100vh;
            min-height: 100vh;
            background: blue;
            display: flex;
            align-items: center;
            line-height: 40%;
            flex-direction: column;

        }
        .bottomBody{
            background: yellow;
            /*justify-content: space-evenly;*/
        }
        .topWord{
            margin-top: 140px;
            height:20%;
        }
        .searchbarWrap, .recommendBarWrap{
            width:85%;
            height: 50px;

        }

        .recommendBarWrap{
            display: flex;
        }
        .barTopWrap{
            display: flex;
            width:100%;
            height: 50px;
        }
        .searchbar, .recommendBar{
            width:90%;
            height: 100%;
            background: white;
            opacity: 0.5;
            /*border: 1px solid black;*/

        }

        #search{
            width:90%;
            height: 100%;
            background: none;
            margin: 0 0 0 20px;
            padding:0;
            border: none;
        }
        #search:focus{
            outline: none;
        }
        #search ::placeholder{
            color: black;
        }
        .searchBtn, .reccomendBtn{
            width:10%;
            height: 100%;
            border: 1px solid black;
            background: darkblue;
            line-height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .searchResult{
            display: none;
            height:200px;
            /*border: 1px solid black;*/
            margin:0;
            padding-top: 10px;
            transition: 1s;
            background: white;
            align-items: center;

        }
        .searchboxLine{
            width:100%;
            height: 10px;
            border-bottom: 2px solid gray;
        }
        .resultBoxText{
            height: 40px;
            width:100%;
            background: skyblue;
            line-height: 40px;
        }
        .recommendWord{
            margin-top: 140px;
            height:20%;
        }
        .footer{
            height: 50px;
            background: red;
        }
    </style>
</head>
<body>
<div class="topBody">
    <div class="topWord"> 찾는 영화가 어디서 서비스중인지 바로 찾아보세요!</div>
    <div class="searchbarWrap">
        <div class="barTopWrap">
            <div class="searchbar">
                <input type="text" id="search" onkeyup="searchEngine()" onblur="hideSearch()" placeholder="찾고 싶은 영화를 입력해주세요">
            </div>
            <div class="searchBtn">버튼</div>
        </div>
        <div class="searchResult"></div>
    </div>


</div>
<div class="bottomBody">
    <div class="recommendWord">클릭 몇번으로 내게 딱맞는 영화를 찾아보세요!</div>
    <div class="recommendBarWrap">
        <div class="recommendBar">추천바임</div>
        <div class="reccomendBtn">버튼</div>
    </div>

</div>
<div class="footer">푸터임</div>
</body>
<script>
    let timer;
    function searchEngine() {
        $('.searchResult').show()
        let search =$('#search').val()
        $('.searchResult').empty()
        if (search ===""){
            $('.searchResult').empty()
            return
        }
        if(timer){
            clearTimeout(timer)
        }
        timer = setTimeout(function(){
            $.ajax({
                type: "GET",
                url: "/search/movie",
                data: {
                    'search_give': search
                },
                success: function (response) {
                    if (response["result"] == "success") {
                        $('.searchResult').empty()
                        $('.searchResult').css('height','200px')
                        let rows = response['data']
                        for (let i = 0; i < rows.length; i++) {
                            let row = rows[i]
                            let searchedTitle = row['title']
                            let searchedPoster = row['poster']
                            let temp = `<div class="resultBoxText">${searchedTitle}</div><div class = "searchboxLine"></div>`
                            $('.searchResult').append(temp)
                            if (search === ""){
                                $('.searchResult').empty()
                            }

                        }

                    }
                }
            })
        },400)
    }
    function hideSearch(){
        $('.searchResult').empty()
        $('.searchResult').css('padding-top',0)
        $('.searchResult').css('border','none')
        $('.searchResult').animate({
            height:'0px'
        },200)
    }

</script>
</html>